# Frontend UI/UX Specification v4.0
# Agentic Retail Forecasting System - Streamlit Interface

**Version:** 4.0
**Date:** 2025-12-04
**Status:** Active Implementation
**Framework:** Streamlit 1.28+
**Design System:** Dark Theme with Agent Status Integration

---

## Table of Contents

1. [Introduction](#1-introduction)
2. [UX Goals & Principles](#2-ux-goals--principles)
3. [Information Architecture](#3-information-architecture)
4. [User Flows](#4-user-flows)
5. [Screen Specifications](#5-screen-specifications)
6. [Component Library](#6-component-library)
7. [Design System](#7-design-system)
8. [Visualization Specifications](#8-visualization-specifications)
9. [Agent Status Integration](#9-agent-status-integration)
10. [State Management](#10-state-management)
11. [Performance Considerations](#11-performance-considerations)
12. [Accessibility](#12-accessibility)
13. [Implementation Guide](#13-implementation-guide)

---

## 1. Introduction

### 1.1 Purpose

This document defines the user experience and visual design for the **Agentic Retail Forecasting System v4.0** built with Streamlit. The system uses a 6-agent architecture with deterministic Python workflow orchestration and LLM-powered reasoning.

### 1.2 Key Changes from v3.3

| Aspect | v3.3 | v4.0 |
|--------|------|------|
| **Framework** | React + TypeScript | Streamlit |
| **Agents** | 3 (Demand, Inventory, Pricing) | 6 (+ Variance, Reforecast, Reallocation) |
| **Real-time Updates** | WebSocket | RunHooks + session_state |
| **Charts** | Recharts | Plotly |
| **Layout** | Single-page sections | Sidebar + Tab-based |
| **Agent Display** | 3 card grid | Sidebar status + reasoning traces |

### 1.3 Target User

**Primary User: Merchandise Planner**
- Reviews forecasts and allocations
- Monitors variance and approves reforecasts
- Makes markdown decisions
- Needs: Transparent reasoning, fast decision-making

### 1.4 Scope (MVP)

- Single category forecasting
- 50 stores across 3 clusters
- 12-week season simulation
- 6-agent workflow with typed output display
- Real-time agent status tracking
- Reasoning traces and key factors display

---

## 2. UX Goals & Principles

### 2.1 Usability Goals

1. **Transparent Reasoning**: Every agent decision displays explanation and key factors
2. **Real-time Feedback**: Agent status updates as workflow executes
3. **Progressive Disclosure**: Summary â†’ Details â†’ Raw data hierarchy
4. **Fast Navigation**: Tab-based interface for quick access to different phases
5. **Trust Building**: Seasonality insights and reasoning traces build confidence

### 2.2 Design Principles

1. **Sidebar Dashboard**: Persistent context (session, agent status, metrics)
2. **Tab-Based Workflow**: Pre-Season | In-Season | Pricing | Analytics
3. **Expandable Details**: Click to see reasoning traces, key factors
4. **Interactive Charts**: Plotly for hover, zoom, pan interactions
5. **Typed Output Display**: Show Pydantic schema structure clearly

### 2.3 Key Interactions

| Interaction | Behavior |
|-------------|----------|
| **Generate Forecast** | Button triggers workflow, sidebar shows agent status |
| **Upload Actuals** | File uploader, auto-triggers variance analysis |
| **View Reasoning** | Expandable sections with reasoning_steps, key_factors |
| **Compare Forecasts** | Original vs reforecast overlay on same chart |
| **Apply Markdown** | Button triggers pricing agent and re-forecast |

---

## 3. Information Architecture

### 3.1 Application Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              HEADER                                      â”‚
â”‚    "Agentic Retail Forecasting System" | Session: abc-123 | Week: 3     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                                                       â”‚
â”‚    SIDEBAR       â”‚                    MAIN CONTENT                       â”‚
â”‚    (Always       â”‚                                                       â”‚
â”‚     Visible)     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                  â”‚  â”‚  TABS: Pre-Season | In-Season | Pricing | Analytics â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚ Session Info â”‚ â”‚                                                       â”‚
â”‚ â”‚ â€¢ ID         â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â€¢ Category   â”‚ â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ â€¢ Week       â”‚ â”‚  â”‚              TAB CONTENT                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                                 â”‚ â”‚
â”‚                  â”‚  â”‚  (Varies by selected tab)                       â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ Agent Status â”‚ â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ (Live)       â”‚ â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ âœ“ Demand     â”‚ â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ â³ Variance  â”‚ â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ â—‹ Reforecast â”‚ â”‚  â”‚                                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                                 â”‚ â”‚
â”‚                  â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                                                 â”‚ â”‚
â”‚ â”‚ Key Metrics  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚ â€¢ MAPE: 12%  â”‚ â”‚                                                       â”‚
â”‚ â”‚ â€¢ Variance   â”‚ â”‚                                                       â”‚
â”‚ â”‚ â€¢ Sell-thru  â”‚ â”‚                                                       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                                       â”‚
â”‚                  â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Tab Structure

| Tab | Content | Primary Actions |
|-----|---------|-----------------|
| **Pre-Season** | Forecast generation, allocation planning | Generate Forecast, Review Allocation |
| **In-Season** | Variance analysis, reforecasting, reallocation | Upload Actuals, Review Variance |
| **Pricing** | Markdown checkpoint, pricing decisions | Apply Markdown |
| **Analytics** | Performance metrics, charts, reports | Export Data |

### 3.3 Sidebar Sections

1. **Session Info**: ID, category, season dates, current week
2. **Agent Status**: Real-time status for all 6 agents (via RunHooks)
3. **Key Metrics**: MAPE, variance, sell-through, stockouts

---

## 4. User Flows

### 4.1 Flow 1: Pre-Season Planning

**Goal**: Generate forecast and review allocation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. User opens app â†’ Pre-Season tab selected by default          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. User selects parameters:                                     â”‚
â”‚    â€¢ Category dropdown (auto-detected from data)                â”‚
â”‚    â€¢ Season start date                                          â”‚
â”‚    â€¢ Forecast horizon (weeks)                                   â”‚
â”‚    â€¢ DC holdback percentage                                     â”‚
â”‚    â€¢ Safety stock percentage                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. User clicks "Generate Forecast" button                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. SIDEBAR: Agent status updates in real-time                   â”‚
â”‚    â³ Running: Demand Forecasting Agent                         â”‚
â”‚    â†’ Demand Agent: Calling run_demand_forecast                  â”‚
â”‚    âœ“ Completed: Demand Forecasting Agent                        â”‚
â”‚    â³ Running: Inventory Allocation Agent                       â”‚
â”‚    â†’ Inventory Agent: Calling cluster_stores                    â”‚
â”‚    ...                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. MAIN: Results display                                        â”‚
â”‚    â€¢ Forecast Summary (total, weekly curve, seasonality)        â”‚
â”‚    â€¢ Allocation Summary (manufacturing qty, DC holdback)        â”‚
â”‚    â€¢ Cluster Cards (3 clusters with store tables)               â”‚
â”‚    â€¢ Reasoning Traces (expandable)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6. User reviews seasonality insights:                           â”‚
â”‚    "Peak weeks: 5-6 (back-to-school preparation)"               â”‚
â”‚    "Monthly effects: April +20%, May -10%"                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 7. User reviews allocation key factors:                         â”‚
â”‚    "NYC-001 received 488 units (9.2%) due to 2.3x avg velocity" â”‚
â”‚    "Value_Conscious cluster reduced to 25% due to trend"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Flow 2: In-Season Variance Analysis

**Goal**: Upload actuals, review variance analysis, approve reforecast

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. User switches to "In-Season" tab                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. User uploads weekly actuals CSV:                             â”‚
â”‚    st.file_uploader("Upload Week X Actuals", type="csv")        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. System automatically triggers Variance Agent                  â”‚
â”‚    SIDEBAR: â³ Running: Variance Analysis Agent                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. Variance Agent output displays:                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ VARIANCE ANALYSIS                                       â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ Variance: 22% | Severity: MODERATE                     â”‚  â”‚
â”‚    â”‚ Trend: INCREASING (20% â†’ 20% â†’ 25%)                    â”‚  â”‚
â”‚    â”‚ Likely Cause: Systematic underforecast                 â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ ğŸ”„ RECOMMENDATION: Reforecast                          â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ â–¼ Agent Reasoning                                       â”‚  â”‚
â”‚    â”‚ "Three weeks of consistent positive variance with      â”‚  â”‚
â”‚    â”‚  increasing trend indicates systematic underforecast.  â”‚  â”‚
â”‚    â”‚  With 9 weeks remaining, reforecasting now allows      â”‚  â”‚
â”‚    â”‚  meaningful correction."                               â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. If should_reforecast=True:                                   â”‚
â”‚    System automatically runs Reforecast Agent                   â”‚
â”‚    SIDEBAR: â³ Running: Reforecast Agent                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6. Bayesian Reforecast output displays:                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ BAYESIAN REFORECAST                                     â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ Updated Forecast: 9,360 units (+17%)                   â”‚  â”‚
â”‚    â”‚ Prior Weight: 35% | Likelihood Weight: 65%             â”‚  â”‚
â”‚    â”‚ Posterior Confidence: 82%                              â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ â–¼ Agent Reasoning                                       â”‚  â”‚
â”‚    â”‚ "Bayesian update with 65% weight on observed data.     â”‚  â”‚
â”‚    â”‚  Strong consistent signal (22% positive variance)      â”‚  â”‚
â”‚    â”‚  justifies higher likelihood weight."                  â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 7. Chart shows original vs reforecast overlay                   â”‚
â”‚    â€¢ Blue line: Original forecast                               â”‚
â”‚    â€¢ Orange line: Updated forecast                              â”‚
â”‚    â€¢ Green bars: Actual sales                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Flow 3: Strategic Reallocation

**Goal**: Review store performance and approve replenishment transfers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Reallocation Agent runs (triggered by variance analysis)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Reallocation Analysis displays:                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ STRATEGIC REPLENISHMENT                                 â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ Strategy: HYBRID (DC + store-to-store)                 â”‚  â”‚
â”‚    â”‚ DC Units to Release: 800                               â”‚  â”‚
â”‚    â”‚ Expected Improvement: +8% sell-through                 â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ HIGH PERFORMERS (stockout risk):                       â”‚  â”‚
â”‚    â”‚ â€¢ NYC-001, CHI-005, SF-008                             â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ UNDERPERFORMERS (excess inventory):                    â”‚  â”‚
â”‚    â”‚ â€¢ RURAL-025, RURAL-031                                 â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ TRANSFER ORDERS:                                        â”‚  â”‚
â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚    â”‚ â”‚ From  â”‚   To    â”‚ Units â”‚ Reason                 â”‚   â”‚  â”‚
â”‚    â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚    â”‚ â”‚ DC    â”‚ NYC-001 â”‚  200  â”‚ High velocity, risk    â”‚   â”‚  â”‚
â”‚    â”‚ â”‚ DC    â”‚ CHI-005 â”‚  180  â”‚ +15% above target      â”‚   â”‚  â”‚
â”‚    â”‚ â”‚RUR-025â”‚ NYC-001 â”‚   50  â”‚ From underperformer    â”‚   â”‚  â”‚
â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 Flow 4: Markdown Decision (Week 6)

**Goal**: Review sell-through and apply markdown if needed

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. User switches to "Pricing" tab at Week 6                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Markdown Checkpoint displays:                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ WEEK 6 MARKDOWN CHECKPOINT                              â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ Sell-Through Analysis:                                  â”‚  â”‚
â”‚    â”‚ â€¢ Current: 52%                                         â”‚  â”‚
â”‚    â”‚ â€¢ Target: 60%                                          â”‚  â”‚
â”‚    â”‚ â€¢ Gap: 8 percentage points                             â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ âš ï¸ BELOW TARGET - Markdown Recommended                 â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. User adjusts elasticity slider (optional):                   â”‚
â”‚    Elasticity: [â—â”€â”€â”€â”€â”€â”€â”€â”€â”€] 2.0                                 â”‚
â”‚    Preview: Gap Ã— Elasticity = 8% Ã— 2.0 = 16% â†’ rounds to 15%  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. User clicks "Apply Markdown"                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. Pricing Agent runs:                                          â”‚
â”‚    SIDEBAR: â³ Running: Pricing Agent                           â”‚
â”‚    â†’ Pricing Agent: Calling calculate_markdown                  â”‚
â”‚    âœ“ Completed: Pricing Agent                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6. Markdown Result displays:                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ MARKDOWN APPLIED                                        â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ Recommended: 15%                                        â”‚  â”‚
â”‚    â”‚ Raw calculation: 16% (rounded to 5%)                   â”‚  â”‚
â”‚    â”‚ Guardrail: âœ“ Under 40% cap                             â”‚  â”‚
â”‚    â”‚                                                         â”‚  â”‚
â”‚    â”‚ â–¼ Agent Reasoning                                       â”‚  â”‚
â”‚    â”‚ "52% sell-through at Week 6 is 8pp below target.       â”‚  â”‚
â”‚    â”‚  15% markdown should accelerate sell-through by        â”‚  â”‚
â”‚    â”‚  12-15% based on historical elasticity."               â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Screen Specifications

### 5.1 Pre-Season Tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PRE-SEASON PLANNING                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ FORECAST PARAMETERS                                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Category: [Women's Dresses     â–¼]                          â”‚ â”‚
â”‚ â”‚ Season Start: [2025-03-01    ğŸ“…]                           â”‚ â”‚
â”‚ â”‚ Horizon: [12] weeks                                         â”‚ â”‚
â”‚ â”‚ DC Holdback: [45] %                                         â”‚ â”‚
â”‚ â”‚ Safety Stock: [20] %                                        â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [Generate Forecast]                                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ FORECAST RESULT                                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Total Demand: 8,000 units                                  â”‚ â”‚
â”‚ â”‚ Manufacturing Qty: 9,600 units (incl. 20% safety)          â”‚ â”‚
â”‚ â”‚ Confidence: 85%                                             â”‚ â”‚
â”‚ â”‚ Model: Ensemble (Prophet + ARIMA)                          â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Seasonality Insights                                      â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Peak Weeks: 5, 6 (back-to-school preparation)          â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Trough Weeks: 11, 12 (end of season)                   â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Seasonal Range: 35%                                     â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Monthly Effects:                                        â”‚ â”‚ â”‚
â”‚ â”‚ â”‚   March: +10% | April: +20% | May: -10%                â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Insight: "Strong spring seasonality with peak demand   â”‚ â”‚ â”‚
â”‚ â”‚ â”‚  expected in late April for back-to-school prep"       â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ [PLOTLY CHART: Weekly Forecast with Confidence Bands]          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  900 â”¤                                                      â”‚ â”‚
â”‚ â”‚  800 â”¤        â•­â”€â”€â•®                                          â”‚ â”‚
â”‚ â”‚  700 â”¤    â•­â”€â”€â•¯    â•°â”€â”€â•®                                      â”‚ â”‚
â”‚ â”‚  600 â”¤â•­â”€â”€â•¯            â•°â”€â”€â•®                                  â”‚ â”‚
â”‚ â”‚  500 â”¤                    â•°â”€â”€â”€â”€â”€â”€â•®                          â”‚ â”‚
â”‚ â”‚  400 â”¤                          â•°â”€â”€â”€â”€                       â”‚ â”‚
â”‚ â”‚      â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€                   â”‚ â”‚
â”‚ â”‚       1  2  3  4  5  6  7  8  9 10 11 12                    â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  â”€â”€â”€ Forecast    â–‘â–‘â–‘ Confidence Band                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ALLOCATION SUMMARY                                          â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Manufacturing: 9,600 units                                  â”‚ â”‚
â”‚ â”‚ DC Holdback: 4,320 units (45%)                             â”‚ â”‚
â”‚ â”‚ Initial Store Allocation: 5,280 units (55%)                â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Reasoning Steps                                           â”‚ â”‚
â”‚ â”‚ 1. Calculated manufacturing qty: 8,000 Ã— 1.20 = 9,600      â”‚ â”‚
â”‚ â”‚ 2. Applied 45% DC holdback: 4,320 units reserved           â”‚ â”‚
â”‚ â”‚ 3. K-means identified 3 clusters (silhouette: 0.52)        â”‚ â”‚
â”‚ â”‚ 4. Fashion_Forward stores show 2.3x avg velocity           â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Key Factors                                               â”‚ â”‚
â”‚ â”‚ â€¢ NYC-001 received 488 units (9.2%) due to 2.3x velocity   â”‚ â”‚
â”‚ â”‚ â€¢ Value_Conscious cluster reduced to 25% (declining trend) â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ CLUSTER ALLOCATIONS                                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚ â”‚ â”‚ Cluster          â”‚ Stores â”‚ Units  â”‚ % Total  â”‚          â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚ â”‚
â”‚ â”‚ â”‚ Fashion_Forward  â”‚   15   â”‚ 2,112  â”‚   40%    â”‚ [View]   â”‚ â”‚
â”‚ â”‚ â”‚ Mainstream       â”‚   20   â”‚ 1,848  â”‚   35%    â”‚ [View]   â”‚ â”‚
â”‚ â”‚ â”‚ Value_Conscious  â”‚   15   â”‚ 1,320  â”‚   25%    â”‚ [View]   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Fashion_Forward Stores (expanded)                         â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚ â”‚ â”‚ Store ID â”‚ Units  â”‚ % Clusterâ”‚ Attributesâ”‚               â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚ â”‚
â”‚ â”‚ â”‚ NYC-001  â”‚  488   â”‚   23.1%  â”‚ [Details] â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ LA-002   â”‚  445   â”‚   21.1%  â”‚ [Details] â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ CHI-005  â”‚  312   â”‚   14.8%  â”‚ [Details] â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ ...      â”‚  ...   â”‚   ...    â”‚ ...       â”‚               â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 In-Season Tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IN-SEASON MONITORING                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ UPLOAD WEEKLY ACTUALS                                       â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Current Week: 3                                             â”‚ â”‚
â”‚ â”‚ [ğŸ“ Choose File] week_3_actuals.csv                        â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Expected format: store_id, category, week, units_sold      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ [PLOTLY CHART: Forecast vs Actual]                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  900 â”¤                                                      â”‚ â”‚
â”‚ â”‚  800 â”¤        â•­â”€â”€â•®     â–                                     â”‚ â”‚
â”‚ â”‚  700 â”¤    â•­â”€â”€â•¯    â•°â”€â”€â•® â–                                     â”‚ â”‚
â”‚ â”‚  600 â”¤â•­â”€â”€â•¯    â–  â–     â•°â”€â”€â•®                                   â”‚ â”‚
â”‚ â”‚  500 â”¤   â–  â–                                                 â”‚ â”‚
â”‚ â”‚  400 â”¤                                                      â”‚ â”‚
â”‚ â”‚      â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€                   â”‚ â”‚
â”‚ â”‚       1  2  3  4  5  6  7  8  9 10 11 12                    â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  â”€â”€â”€ Original Forecast  â”€â”€â”€ Reforecast  â–  Actual           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ VARIANCE ANALYSIS                                           â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚ â”‚ â”‚ Variance: 22%        Severity: MODERATE    ğŸŸ¡            â”‚â”‚ â”‚
â”‚ â”‚ â”‚ Trend: INCREASING    Likely Cause: Systematic underforecastâ”‚
â”‚ â”‚ â”‚                                                          â”‚â”‚ â”‚
â”‚ â”‚ â”‚ ğŸ”„ RECOMMENDATION: Reforecast triggered                  â”‚â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Agent Reasoning                                           â”‚ â”‚
â”‚ â”‚ "Three-week variance of 22% exceeds typical threshold,     â”‚ â”‚
â”‚ â”‚  but more importantly, the trend is increasing (20% â†’ 20%  â”‚ â”‚
â”‚ â”‚  â†’ 25%). This pattern suggests systematic underforecast    â”‚ â”‚
â”‚ â”‚  rather than random volatility. Given 9 weeks remaining,   â”‚ â”‚
â”‚ â”‚  we have time to correct. Recommending Bayesian reforecast â”‚ â”‚
â”‚ â”‚  to update remaining weeks."                                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ BAYESIAN REFORECAST                                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚ â”‚ â”‚ Updated Total: 9,360 units (+17% adjustment)            â”‚â”‚ â”‚
â”‚ â”‚ â”‚ Prior Weight: 35%    Likelihood Weight: 65%             â”‚â”‚ â”‚
â”‚ â”‚ â”‚ Posterior Confidence: 82%                               â”‚â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Week-by-Week Comparison:                                    â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚ â”‚
â”‚ â”‚ â”‚ Week  â”‚ Original â”‚ Updated  â”‚ Change   â”‚                 â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚ â”‚
â”‚ â”‚ â”‚  4    â”‚   750    â”‚   900    â”‚  +20%    â”‚                 â”‚ â”‚
â”‚ â”‚ â”‚  5    â”‚   800    â”‚   960    â”‚  +20%    â”‚                 â”‚ â”‚
â”‚ â”‚ â”‚  6    â”‚   850    â”‚  1,020   â”‚  +20%    â”‚                 â”‚ â”‚
â”‚ â”‚ â”‚ ...   â”‚   ...    â”‚   ...    â”‚  ...     â”‚                 â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Agent Reasoning                                           â”‚ â”‚
â”‚ â”‚ "Applying Bayesian update with conjugate Gaussian prior.   â”‚ â”‚
â”‚ â”‚  Given strong consistent signal (22% positive variance,    â”‚ â”‚
â”‚ â”‚  increasing trend), posterior weights likelihood at 65%.   â”‚ â”‚
â”‚ â”‚  Updated forecast: +17% adjustment for weeks 4-12."        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ STRATEGIC REPLENISHMENT                                     â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Strategy: HYBRID    Expected Improvement: +8% sell-through â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ DC Units Available: 3,200    To Release: 800               â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ High Performers (stockout risk): NYC-001, CHI-005, SF-008  â”‚ â”‚
â”‚ â”‚ Underperformers: RURAL-025, RURAL-031                      â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Transfer Orders:                                            â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚ â”‚ â”‚ From  â”‚   To    â”‚ Units â”‚ Reason                     â”‚   â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚ â”‚ â”‚ DC    â”‚ NYC-001 â”‚  200  â”‚ High velocity, stockout in 2wkâ”‚ â”‚
â”‚ â”‚ â”‚ DC    â”‚ CHI-005 â”‚  180  â”‚ Sell-through 15% above targetâ”‚  â”‚
â”‚ â”‚ â”‚RUR-025â”‚ NYC-001 â”‚   50  â”‚ Transfer from underperformer â”‚  â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Pricing Tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PRICING / MARKDOWN                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WEEK 6 MARKDOWN CHECKPOINT                                  â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚ â”‚ â”‚ Current Sell-Through: 52%                               â”‚â”‚ â”‚
â”‚ â”‚ â”‚ Target Sell-Through: 60%                                â”‚â”‚ â”‚
â”‚ â”‚ â”‚ Gap: 8 percentage points                                â”‚â”‚ â”‚
â”‚ â”‚ â”‚                                                          â”‚â”‚ â”‚
â”‚ â”‚ â”‚ âš ï¸ BELOW TARGET - Markdown Recommended                  â”‚â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MARKDOWN CALCULATOR                                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Elasticity Coefficient:                                     â”‚ â”‚
â”‚ â”‚ [â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€] 2.0                              â”‚ â”‚
â”‚ â”‚  1.0                                    3.0                 â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Calculation Preview:                                        â”‚ â”‚
â”‚ â”‚ â€¢ Gap: 8%                                                   â”‚ â”‚
â”‚ â”‚ â€¢ Elasticity: 2.0                                           â”‚ â”‚
â”‚ â”‚ â€¢ Raw Markdown: 8% Ã— 2.0 = 16%                             â”‚ â”‚
â”‚ â”‚ â€¢ Rounded: 15% (nearest 5%)                                â”‚ â”‚
â”‚ â”‚ â€¢ Final: 15% (under 40% cap âœ“)                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [Apply Markdown]                                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MARKDOWN RESULT                                             â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ âœ“ 15% Markdown Applied at Week 6                           â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Details:                                                    â”‚ â”‚
â”‚ â”‚ â€¢ Recommended: 15%                                          â”‚ â”‚
â”‚ â”‚ â€¢ Current Sell-Through: 52%                                â”‚ â”‚
â”‚ â”‚ â€¢ Target Sell-Through: 60%                                 â”‚ â”‚
â”‚ â”‚ â€¢ Elasticity Used: 2.0                                     â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Guardrail Validation:                                       â”‚ â”‚
â”‚ â”‚ âœ“ Under 40% cap                                            â”‚ â”‚
â”‚ â”‚ âœ“ Rounded to 5%                                            â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â–¼ Agent Reasoning                                           â”‚ â”‚
â”‚ â”‚ "Week 6 checkpoint shows 52% sell-through, 8 percentage    â”‚ â”‚
â”‚ â”‚  points below 60% target. With 6 weeks remaining and 48%   â”‚ â”‚
â”‚ â”‚  inventory still on hand, markdown intervention warranted. â”‚ â”‚
â”‚ â”‚  Gap Ã— Elasticity formula: 8% Ã— 2.0 = 16% â†’ rounds to 15%. â”‚ â”‚
â”‚ â”‚  Historical data suggests 15% markdown drives 12-15%       â”‚ â”‚
â”‚ â”‚  sell-through improvement."                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 Analytics Tab

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ANALYTICS                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚ â”‚ FORECAST      â”‚ â”‚ BUSINESS      â”‚ â”‚ SYSTEM        â”‚          â”‚
â”‚ â”‚ ACCURACY      â”‚ â”‚ IMPACT        â”‚ â”‚ PERFORMANCE   â”‚          â”‚
â”‚ â”‚               â”‚ â”‚               â”‚ â”‚               â”‚          â”‚
â”‚ â”‚ MAPE: 12%     â”‚ â”‚ Stockouts: 3  â”‚ â”‚ Runtime: 45s  â”‚          â”‚
â”‚ â”‚ Target: <20%âœ“ â”‚ â”‚ Overstock:    â”‚ â”‚ Target: <60sâœ“ â”‚          â”‚
â”‚ â”‚               â”‚ â”‚ 1,200 units   â”‚ â”‚               â”‚          â”‚
â”‚ â”‚ Bias: +2%     â”‚ â”‚               â”‚ â”‚ Guardrail     â”‚          â”‚
â”‚ â”‚ Target: Â±5%âœ“  â”‚ â”‚ Markdown:     â”‚ â”‚ Pass: 100%    â”‚          â”‚
â”‚ â”‚               â”‚ â”‚ 15% applied   â”‚ â”‚               â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚ [PLOTLY CHART: MAPE by Week]                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  25% â”¤                                                      â”‚ â”‚
â”‚ â”‚  20% â”¤  â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ threshold             â”‚ â”‚
â”‚ â”‚  15% â”¤        â–„                                             â”‚ â”‚
â”‚ â”‚  10% â”¤  â–„  â–„     â–„  â–„  â–„  â–„  â–„                             â”‚ â”‚
â”‚ â”‚   5% â”¤                                                      â”‚ â”‚
â”‚ â”‚      â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€                   â”‚ â”‚
â”‚ â”‚       1  2  3  4  5  6  7  8  9 10 11 12                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ [PLOTLY CHART: Variance Trend]                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  30% â”¤                                                      â”‚ â”‚
â”‚ â”‚  20% â”¤  â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ threshold               â”‚ â”‚
â”‚ â”‚  15% â”¤        â•­â”€â”€â•®                                          â”‚ â”‚
â”‚ â”‚  10% â”¤  â•­â”€â”€â”€â”€â•¯    â•°â”€â”€â”€â”€â•®                                    â”‚ â”‚
â”‚ â”‚   5% â”¤ â•¯              â•°â”€â”€â”€â”€                                 â”‚ â”‚
â”‚ â”‚      â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€                   â”‚ â”‚
â”‚ â”‚       1  2  3  4  5  6  7  8  9 10 11 12                    â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚  â–² Reforecast triggered (Week 3)                           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WEEKLY DETAIL TABLE                                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Week â”‚ Forecast â”‚ Actual â”‚ Variance â”‚ MAPE    â”‚ Status â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚ â”‚  1   â”‚   600    â”‚  720   â”‚  +20%    â”‚  20%    â”‚  ğŸŸ¡    â”‚ â”‚ â”‚
â”‚ â”‚ â”‚  2   â”‚   650    â”‚  780   â”‚  +20%    â”‚  20%    â”‚  ğŸŸ¡    â”‚ â”‚ â”‚
â”‚ â”‚ â”‚  3   â”‚   700    â”‚  875   â”‚  +25%    â”‚  25%    â”‚  ğŸ”´    â”‚ â”‚ â”‚
â”‚ â”‚ â”‚  4*  â”‚   900    â”‚  920   â”‚  +2%     â”‚   2%    â”‚  ğŸŸ¢    â”‚ â”‚ â”‚
â”‚ â”‚ â”‚  5*  â”‚   960    â”‚  970   â”‚  +1%     â”‚   1%    â”‚  ğŸŸ¢    â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ ...  â”‚   ...    â”‚  ...   â”‚   ...    â”‚  ...    â”‚  ...   â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ * Using reforecast baseline                                 â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ [Export CSV]                                                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Component Library

### 6.1 Streamlit Components Used

| Component | Usage | Example |
|-----------|-------|---------|
| `st.sidebar` | Persistent sidebar with session info, agent status | Always visible |
| `st.tabs` | Main navigation (Pre-Season, In-Season, Pricing, Analytics) | 4 tabs |
| `st.columns` | Layout within tabs | `col1, col2 = st.columns([2, 1])` |
| `st.expander` | Collapsible sections for reasoning, details | "Agent Reasoning" |
| `st.metric` | KPI display with delta | MAPE, variance, sell-through |
| `st.dataframe` | Data tables with sorting | Store allocations, weekly data |
| `st.plotly_chart` | Interactive charts | Forecast, variance trends |
| `st.file_uploader` | CSV upload for actuals | Weekly actuals upload |
| `st.selectbox` | Dropdown selection | Category, cluster selection |
| `st.slider` | Parameter adjustment | Elasticity, DC holdback |
| `st.button` | Action triggers | "Generate Forecast", "Apply Markdown" |
| `st.progress` | Loading indicator | During agent execution |
| `st.status` | Multi-step status display | Agent workflow progress |
| `st.toast` | Notifications | Success/error messages |
| `st.warning` / `st.error` / `st.success` | Alert boxes | Variance alerts |

### 6.2 Custom Components

```python
# components/agent_status_card.py
def render_agent_status(agent_name: str, status: str, last_run: str = None):
    """
    Render agent status in sidebar

    status: "idle" | "running" | "completed" | "error"
    """
    icons = {
        "idle": "â—‹",
        "running": "â³",
        "completed": "âœ“",
        "error": "âœ—"
    }
    colors = {
        "idle": "gray",
        "running": "blue",
        "completed": "green",
        "error": "red"
    }

    st.markdown(f"""
    <div style="display: flex; align-items: center; gap: 8px;">
        <span style="color: {colors[status]};">{icons[status]}</span>
        <span>{agent_name}</span>
        {f'<span style="color: gray; font-size: 12px;">({last_run})</span>' if last_run else ''}
    </div>
    """, unsafe_allow_html=True)

# components/reasoning_expander.py
def render_reasoning(title: str, reasoning_steps: list, key_factors: list = None):
    """
    Render expandable reasoning section
    """
    with st.expander(f"â–¼ {title}"):
        st.markdown("**Reasoning Steps:**")
        for i, step in enumerate(reasoning_steps, 1):
            st.markdown(f"{i}. {step}")

        if key_factors:
            st.markdown("**Key Factors:**")
            for factor in key_factors:
                st.markdown(f"â€¢ {factor}")

# components/variance_alert.py
def render_variance_alert(variance_pct: float, severity: str, should_reforecast: bool):
    """
    Render variance alert with appropriate styling
    """
    if severity == "low":
        st.success(f"ğŸŸ¢ Variance {variance_pct:.0%} - Tracking well")
    elif severity == "moderate":
        st.warning(f"ğŸŸ¡ Variance {variance_pct:.0%} - Elevated variance")
    else:
        st.error(f"ğŸ”´ Variance {variance_pct:.0%} - High variance {'- Reforecast triggered' if should_reforecast else ''}")

# components/metric_card.py
def render_metric_card(title: str, value: str, target: str, status: str):
    """
    Render metric with target comparison
    """
    delta_color = "normal" if status == "success" else "inverse"
    st.metric(
        label=title,
        value=value,
        delta=f"Target: {target}" if status == "success" else f"Below target ({target})",
        delta_color=delta_color
    )
```

---

## 7. Design System

### 7.1 Color Palette

```python
# Streamlit theme configuration (.streamlit/config.toml)
[theme]
primaryColor = "#5E6AD2"          # Linear purple-blue
backgroundColor = "#0E1117"       # Dark background
secondaryBackgroundColor = "#1A1D23"  # Card background
textColor = "#FAFAFA"             # Primary text
font = "sans serif"
```

**Status Colors:**
```python
COLORS = {
    "success": "#00D084",    # Green (variance <10%)
    "warning": "#F5A623",    # Amber (variance 10-20%)
    "error": "#F97066",      # Red (variance >20%)
    "info": "#5B8DEF",       # Blue (information)
    "muted": "#6B7280",      # Gray (secondary text)
}

AGENT_COLORS = {
    "demand": "#5B8DEF",      # Blue
    "inventory": "#00D084",   # Green
    "pricing": "#F59E0B",     # Amber
    "variance": "#8B5CF6",    # Purple
    "reforecast": "#EC4899",  # Pink
    "reallocation": "#14B8A6" # Teal
}
```

### 7.2 Typography

```python
# Use Streamlit's default font stack
# Primary: Inter, system-ui, sans-serif
# Monospace: SF Mono, Monaco, monospace (for numbers)

# Custom CSS for typography
st.markdown("""
<style>
    .stMetricValue { font-family: 'SF Mono', monospace; }
    .stDataFrame { font-family: 'SF Mono', monospace; }
    .reasoning-text { font-style: italic; color: #9CA3AF; }
</style>
""", unsafe_allow_html=True)
```

### 7.3 Spacing

```python
# Consistent spacing using Streamlit containers
PADDING = {
    "section": 24,    # Between major sections
    "card": 16,       # Within cards
    "element": 8,     # Between elements
}

# Use columns for layout
col1, col2, col3 = st.columns([1, 2, 1])  # Ratio-based
col1, col2 = st.columns(2)                 # Equal width
```

---

## 8. Visualization Specifications

### 8.1 Forecast Chart (Plotly)

```python
import plotly.graph_objects as go

def create_forecast_chart(forecast_by_week, actual_sales, confidence_lower, confidence_upper, reforecast=None):
    fig = go.Figure()

    weeks = list(range(1, len(forecast_by_week) + 1))

    # Confidence band
    fig.add_trace(go.Scatter(
        x=weeks + weeks[::-1],
        y=confidence_upper + confidence_lower[::-1],
        fill='toself',
        fillcolor='rgba(94, 106, 210, 0.2)',
        line=dict(color='rgba(255,255,255,0)'),
        name='Confidence Band'
    ))

    # Original forecast line
    fig.add_trace(go.Scatter(
        x=weeks,
        y=forecast_by_week,
        mode='lines+markers',
        name='Forecast',
        line=dict(color='#5E6AD2', width=2)
    ))

    # Reforecast line (if exists)
    if reforecast:
        fig.add_trace(go.Scatter(
            x=weeks,
            y=reforecast,
            mode='lines+markers',
            name='Reforecast',
            line=dict(color='#F59E0B', width=2, dash='dash')
        ))

    # Actual sales bars
    actual_weeks = [i+1 for i, v in enumerate(actual_sales) if v is not None]
    actual_values = [v for v in actual_sales if v is not None]

    fig.add_trace(go.Bar(
        x=actual_weeks,
        y=actual_values,
        name='Actual',
        marker_color='#00D084',
        opacity=0.7
    ))

    fig.update_layout(
        template='plotly_dark',
        paper_bgcolor='rgba(0,0,0,0)',
        plot_bgcolor='rgba(0,0,0,0)',
        xaxis_title='Week',
        yaxis_title='Units',
        legend=dict(orientation='h', yanchor='bottom', y=1.02),
        margin=dict(l=40, r=40, t=40, b=40)
    )

    return fig
```

### 8.2 Variance Trend Chart

```python
def create_variance_chart(variance_by_week, threshold=0.20):
    fig = go.Figure()

    weeks = list(range(1, len(variance_by_week) + 1))

    # Threshold line
    fig.add_hline(
        y=threshold,
        line_dash="dash",
        line_color="#F97066",
        annotation_text=f"Threshold ({threshold:.0%})"
    )

    # Variance line with color coding
    colors = ['#00D084' if v < 0.10 else '#F5A623' if v < 0.20 else '#F97066' for v in variance_by_week]

    fig.add_trace(go.Scatter(
        x=weeks,
        y=variance_by_week,
        mode='lines+markers',
        name='Variance',
        line=dict(color='#5E6AD2', width=2),
        marker=dict(color=colors, size=10)
    ))

    fig.update_layout(
        template='plotly_dark',
        paper_bgcolor='rgba(0,0,0,0)',
        plot_bgcolor='rgba(0,0,0,0)',
        xaxis_title='Week',
        yaxis_title='Variance %',
        yaxis_tickformat='.0%'
    )

    return fig
```

### 8.3 Allocation Pie Chart

```python
def create_cluster_allocation_chart(cluster_allocations):
    fig = go.Figure(data=[go.Pie(
        labels=[c['cluster_name'] for c in cluster_allocations],
        values=[c['total_units'] for c in cluster_allocations],
        hole=0.4,
        marker_colors=['#5B8DEF', '#00D084', '#F59E0B']
    )])

    fig.update_layout(
        template='plotly_dark',
        paper_bgcolor='rgba(0,0,0,0)',
        showlegend=True,
        legend=dict(orientation='h', yanchor='bottom', y=-0.2)
    )

    return fig
```

---

## 9. Agent Status Integration

### 9.1 RunHooks Implementation

```python
# utils/agent_status_hooks.py
from agents import RunHooks, RunContextWrapper
import streamlit as st

class StreamlitStatusHooks(RunHooks):
    """
    Custom hooks to update Streamlit session_state with agent status
    """

    def on_agent_start(self, context: RunContextWrapper, agent) -> None:
        st.session_state.agent_status[agent.name] = {
            "status": "running",
            "message": f"Running: {agent.name}",
            "started_at": datetime.now()
        }

    def on_agent_end(self, context: RunContextWrapper, agent, output) -> None:
        st.session_state.agent_status[agent.name] = {
            "status": "completed",
            "message": f"Completed: {agent.name}",
            "completed_at": datetime.now()
        }

    def on_tool_start(self, context: RunContextWrapper, agent, tool) -> None:
        st.session_state.agent_status[agent.name]["message"] = f"{agent.name}: Calling {tool.name}"

    def on_tool_end(self, context: RunContextWrapper, agent, tool, result) -> None:
        st.session_state.agent_status[agent.name]["message"] = f"{agent.name}: {tool.name} completed"
```

### 9.2 Sidebar Status Display

```python
# components/sidebar.py
def render_sidebar():
    with st.sidebar:
        st.title("Dashboard")

        # Session Info
        st.subheader("Session")
        st.text(f"ID: {st.session_state.session_id[:8]}...")
        st.text(f"Category: {st.session_state.category}")
        st.text(f"Week: {st.session_state.current_week} of 12")

        st.divider()

        # Agent Status
        st.subheader("Agent Status")

        agents = [
            ("Demand", "demand_agent"),
            ("Inventory", "inventory_agent"),
            ("Pricing", "pricing_agent"),
            ("Variance", "variance_agent"),
            ("Reforecast", "reforecast_agent"),
            ("Reallocation", "reallocation_agent")
        ]

        for display_name, agent_key in agents:
            status = st.session_state.agent_status.get(agent_key, {"status": "idle"})
            render_agent_status(display_name, status["status"], status.get("message"))

        st.divider()

        # Key Metrics
        st.subheader("Key Metrics")

        if st.session_state.forecast_result:
            st.metric("Total Forecast", f"{st.session_state.forecast_result.total_demand:,}")

        if st.session_state.variance_result:
            variance = st.session_state.variance_result.variance_pct
            st.metric("Current Variance", f"{variance:.0%}")

        if st.session_state.allocation_result:
            sell_through = st.session_state.total_sold / st.session_state.total_allocated
            st.metric("Sell-Through", f"{sell_through:.0%}")
```

---

## 10. State Management

### 10.1 Session State Structure

```python
# Initialize session state
def init_session_state():
    if 'session_id' not in st.session_state:
        st.session_state.session_id = str(uuid.uuid4())

    if 'agent_status' not in st.session_state:
        st.session_state.agent_status = {}

    if 'context' not in st.session_state:
        st.session_state.context = None

    # Workflow state
    st.session_state.setdefault('current_week', 0)
    st.session_state.setdefault('category', None)

    # Results
    st.session_state.setdefault('forecast_result', None)
    st.session_state.setdefault('original_forecast', None)  # For comparison
    st.session_state.setdefault('allocation_result', None)
    st.session_state.setdefault('variance_result', None)
    st.session_state.setdefault('reforecast_result', None)
    st.session_state.setdefault('reallocation_result', None)
    st.session_state.setdefault('markdown_result', None)

    # Tracking
    st.session_state.setdefault('actual_sales', [])
    st.session_state.setdefault('variance_history', [])
    st.session_state.setdefault('total_allocated', 0)
    st.session_state.setdefault('total_sold', 0)
```

### 10.2 State Updates

```python
# After forecast generation
def update_forecast_state(result):
    st.session_state.forecast_result = result.final_output
    st.session_state.original_forecast = result.final_output  # Save original

# After variance analysis
def update_variance_state(result):
    st.session_state.variance_result = result.final_output
    st.session_state.variance_history.append(result.final_output)

# After reforecast
def update_reforecast_state(result):
    st.session_state.reforecast_result = result.final_output
    # Update forecast to reforecast
    st.session_state.forecast_result = ForecastResult(
        total_demand=result.final_output.updated_total,
        forecast_by_week=result.final_output.updated_forecast_by_week,
        # ... other fields from original + updates
    )
```

---

## 11. Performance Considerations

### 11.1 Caching

```python
# Cache expensive computations
@st.cache_data
def load_training_data(category: str):
    """Cache historical data loading"""
    loader = TrainingDataLoader()
    return loader.get_historical_sales(category)

@st.cache_resource
def get_data_loader():
    """Cache data loader instance"""
    return TrainingDataLoader()

# Don't cache agent results (they depend on session state)
```

### 11.2 Progress Display

```python
# Use st.status for multi-step operations
def run_forecast_workflow():
    with st.status("Running forecast workflow...", expanded=True) as status:
        st.write("Initializing...")

        # Run Demand Agent
        status.update(label="Running Demand Agent...")
        st.write("â³ Demand Agent: Training Prophet model...")
        demand_result = await Runner.run(demand_agent, ...)
        st.write("âœ“ Demand Agent: Complete")

        # Run Inventory Agent
        status.update(label="Running Inventory Agent...")
        st.write("â³ Inventory Agent: Clustering stores...")
        allocation_result = await Runner.run(inventory_agent, ...)
        st.write("âœ“ Inventory Agent: Complete")

        status.update(label="Complete!", state="complete")

    return demand_result, allocation_result
```

### 11.3 Async Execution

```python
# Use asyncio for agent execution
import asyncio

async def run_agents_async():
    demand_result = await Runner.run(demand_agent, ...)
    return demand_result

# Run in Streamlit
if st.button("Generate Forecast"):
    result = asyncio.run(run_agents_async())
```

---

## 12. Accessibility

### 12.1 Keyboard Navigation

- All interactive elements accessible via Tab
- Forms submit with Enter key
- Expanders toggle with Enter/Space

### 12.2 Screen Reader Support

```python
# Use descriptive labels
st.selectbox("Select product category", options, help="Choose the category to forecast")

# Add alt text to charts
fig.update_layout(
    title=dict(text="Weekly Forecast vs Actual Sales")
)
```

### 12.3 Color Contrast

- Text on dark background: 21:1 ratio
- All status indicators include text, not just color
- Charts include legends and labels

---

## 13. Implementation Guide

### 13.1 File Structure

```
backend/
â”œâ”€â”€ streamlit_app.py              # Main Streamlit app
â”œâ”€â”€ pages/                        # Multi-page support (if needed)
â”‚   â””â”€â”€ analytics.py
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ sidebar.py                # Sidebar rendering
â”‚   â”œâ”€â”€ agent_status.py           # Agent status display
â”‚   â”œâ”€â”€ reasoning_display.py      # Reasoning traces
â”‚   â”œâ”€â”€ forecast_charts.py        # Plotly charts
â”‚   â””â”€â”€ data_tables.py            # DataFrames
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ agent_status_hooks.py     # RunHooks for status
â”‚   â””â”€â”€ sidebar_status.py         # Sidebar rendering
â””â”€â”€ .streamlit/
    â””â”€â”€ config.toml               # Theme configuration
```

### 13.2 Main App Structure

```python
# streamlit_app.py
import streamlit as st
from components.sidebar import render_sidebar
from utils.session import init_session_state

# Page config
st.set_page_config(
    page_title="Agentic Retail Forecasting",
    page_icon="ğŸ¯",
    layout="wide",
    initial_sidebar_state="expanded"
)

# Initialize
init_session_state()

# Sidebar
render_sidebar()

# Main content
st.title("Agentic Retail Forecasting System")

# Tabs
tab1, tab2, tab3, tab4 = st.tabs(["Pre-Season", "In-Season", "Pricing", "Analytics"])

with tab1:
    render_preseason_tab()

with tab2:
    render_inseason_tab()

with tab3:
    render_pricing_tab()

with tab4:
    render_analytics_tab()
```

### 13.3 Running the App

```bash
cd backend
streamlit run streamlit_app.py
```

---

## Summary of Changes from v3.3

| Aspect | v3.3 (React) | v4.0 (Streamlit) |
|--------|--------------|------------------|
| **Framework** | React + TypeScript + Vite | Streamlit 1.28+ |
| **State Management** | TanStack Query + React state | st.session_state |
| **Real-time Updates** | WebSocket | RunHooks â†’ session_state |
| **Charts** | Recharts | Plotly |
| **Layout** | Single-page sections | Sidebar + Tabs |
| **Components** | Shadcn/ui | Streamlit native |
| **Agents Displayed** | 3 (Demand, Inventory, Pricing) | 6 (+ Variance, Reforecast, Reallocation) |
| **New Features** | - | Reasoning traces, key factors, seasonality |

---

**Document Owner:** Independent Study Project
**Last Updated:** 2025-12-04
**Version:** 4.0

---

*Document generated by BMad Master v4.0*
